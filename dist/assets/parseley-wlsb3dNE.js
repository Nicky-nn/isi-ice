import{o as q}from"./leac-fJIxp7iX.js";import{m as s,o as f,f as H,a as J,b as N,c as j,l as K,d as c,t as u,e as L,g as _,h as $,i as C,r as P}from"./peberminta-DElK8MKc.js";const O="(?:[ \\t\\r\\n\\f]*)",F="(?:\\n|\\r\\n|\\r|\\f)",w="[^\\x00-\\x7F]",y="(?:\\\\[0-9a-f]{1,6}(?:\\r\\n|[ \\n\\r\\t\\f])?)",x="(?:\\\\[^\\n\\r\\f0-9a-f])",Q=`(?:[_a-z]|${w}|${y}|${x})`,M=`(?:[_a-z0-9-]|${w}|${y}|${x})`,U=`(?:${M}+)`,X=`(?:[-]?${Q}${M}*)`,Y=`'([^\\n\\r\\f\\\\']|\\\\${F}|${w}|${y}|${x})*'`,ee=`"([^\\n\\r\\f\\\\"]|\\\\${F}|${w}|${y}|${x})*"`,ne=q([{name:"ws",regex:new RegExp(O)},{name:"hash",regex:new RegExp(`#${U}`,"i")},{name:"ident",regex:new RegExp(X,"i")},{name:"str1",regex:new RegExp(Y,"i")},{name:"str2",regex:new RegExp(ee,"i")},{name:"*"},{name:"."},{name:","},{name:"["},{name:"]"},{name:"="},{name:">"},{name:"|"},{name:"+"},{name:"~"},{name:"^"},{name:"$"}]),te=q([{name:"unicode",regex:new RegExp(y,"i")},{name:"escape",regex:new RegExp(x,"i")},{name:"any",regex:new RegExp("[\\s\\S]","i")}]);function W([e,n,t],[r,i,p]){return[e+r,n+i,t+p]}function ae(e){return e.reduce(W,[0,0,0])}const re=u(e=>e.name==="unicode"?String.fromCodePoint(parseInt(e.text.slice(1),16)):void 0),ie=u(e=>e.name==="escape"?e.text.slice(1):void 0),se=u(e=>e.name==="any"?e.text:void 0),ce=s(N(_(re,ie,se)),e=>e.join(""));function b(e){const n=te(e);return ce({tokens:n.tokens,options:void 0},0).value}function a(e){return u(n=>n.name===e?!0:void 0)}const A=u(e=>e.name==="ws"?null:void 0),E=$(A,null);function l(e){return j(E,e,E)}const d=u(e=>e.name==="ident"?b(e.text):void 0),oe=u(e=>e.name==="hash"?b(e.text.slice(1)):void 0),ue=u(e=>e.name.startsWith("str")?b(e.text.slice(1,-1)):void 0),Z=L($(d,""),a("|")),k=f(c(Z,d,(e,n)=>({name:n,namespace:e})),s(d,e=>({name:e,namespace:null}))),pe=f(c(Z,a("*"),e=>({type:"universal",namespace:e,specificity:[0,0,0]})),s(a("*"),()=>({type:"universal",namespace:null,specificity:[0,0,0]}))),fe=s(k,({name:e,namespace:n})=>({type:"tag",name:e,namespace:n,specificity:[0,0,1]})),me=c(a("."),d,(e,n)=>({type:"class",name:n,specificity:[0,1,0]})),le=s(oe,e=>({type:"id",name:e,specificity:[1,0,0]})),R=u(e=>{if(e.name==="ident"){if(e.text==="i"||e.text==="I")return"i";if(e.text==="s"||e.text==="S")return"s"}}),de=f(c(ue,$(P(E,R),null),(e,n)=>({value:e,modifier:n})),c(d,$(P(A,R),null),(e,n)=>({value:e,modifier:n}))),ye=_(s(a("="),()=>"="),c(a("~"),a("="),()=>"~="),c(a("|"),a("="),()=>"|="),c(a("^"),a("="),()=>"^="),c(a("$"),a("="),()=>"$="),c(a("*"),a("="),()=>"*=")),xe=C(a("["),l(k),a("]"),(e,{name:n,namespace:t})=>({type:"attrPresence",name:n,namespace:t,specificity:[0,1,0]})),ge=j(a("["),C(l(k),ye,l(de),({name:e,namespace:n},t,{value:r,modifier:i})=>({type:"attrValue",name:e,namespace:n,matcher:t,value:r,modifier:i,specificity:[0,1,0]})),a("]")),he=f(xe,ge),$e=f(pe,fe),z=_(le,me,he),T=s(f(H($e,N(z)),J(z)),e=>({type:"compound",list:e,specificity:ae(e.map(n=>n.specificity))})),_e=_(s(a(">"),()=>">"),s(a("+"),()=>"+"),s(a("~"),()=>"~"),c(a("|"),a("|"),()=>"||")),we=f(l(_e),s(A,()=>" ")),Se=K(T,s(we,e=>(n,t)=>({type:"compound",list:[...t.list,{type:"combinator",combinator:e,left:n,specificity:n.specificity}],specificity:W(n.specificity,t.specificity)})),T);function Ee(e,n){if(!(typeof n=="string"||n instanceof String))throw new Error("Expected a selector string. Actual input is not a string!");const t=ne(n);if(!t.complete)throw new Error(`The input "${n}" was only partially tokenized, stopped at offset ${t.offset}!
`+V(n,t.offset));const r=l(e)({tokens:t.tokens,options:void 0},0);if(!r.matched)throw new Error(`No match for "${n}" input!`);if(r.position<t.tokens.length){const i=t.tokens[r.position];throw new Error(`The input "${n}" was only partially parsed, stopped at offset ${i.offset}!
`+V(n,i.offset,i.len))}return r.value}function V(e,n,t=1){return`${e.replace(/(\t)|(\r)|(\n)/g,(r,i,p)=>i?"␉":p?"␍":"␊")}
${"".padEnd(n)}${"^".repeat(t)}`}function ve(e){return Ee(Se,e)}function o(e){if(!e.type)throw new Error("This is not an AST node.");switch(e.type){case"universal":return g(e.namespace)+"*";case"tag":return g(e.namespace)+m(e.name);case"class":return"."+m(e.name);case"id":return"#"+m(e.name);case"attrPresence":return`[${g(e.namespace)}${m(e.name)}]`;case"attrValue":return`[${g(e.namespace)}${m(e.name)}${e.matcher}"${be(e.value)}"${e.modifier?e.modifier:""}]`;case"combinator":return o(e.left)+e.combinator;case"compound":return e.list.reduce((n,t)=>t.type==="combinator"?o(t)+n:n+o(t),"");case"list":return e.list.map(o).join(",")}}function g(e){return e||e===""?m(e)+"|":""}function h(e){return`\\${e.codePointAt(0).toString(16)} `}function m(e){return e.replace(/(^[0-9])|(^-[0-9])|(^-$)|([-0-9a-zA-Z_]|[^\x00-\x7F])|(\x00)|([\x01-\x1f]|\x7f)|([\s\S])/g,(n,t,r,i,p,D,v,G)=>t?h(t):r?"-"+h(r.slice(1)):i?"\\-":p||(D?"�":v?h(v):"\\"+G))}function be(e){return e.replace(/(")|(\\)|(\x00)|([\x01-\x1f]|\x7f)/g,(n,t,r,i,p)=>t?'\\"':r?"\\\\":i?"�":h(p))}function S(e){if(!e.type)throw new Error("This is not an AST node.");switch(e.type){case"compound":{e.list.forEach(S),e.list.sort((n,t)=>B(I(n),I(t)));break}case"combinator":{S(e.left);break}case"list":{e.list.forEach(S),e.list.sort((n,t)=>o(n)<o(t)?-1:1);break}}return e}function I(e){switch(e.type){case"universal":return[1];case"tag":return[1];case"id":return[2];case"class":return[3,e.name];case"attrPresence":return[4,o(e)];case"attrValue":return[5,o(e)];case"combinator":return[15,o(e)]}}function Pe(e,n){return B(e,n)}function B(e,n){if(!Array.isArray(e)||!Array.isArray(n))throw new Error("Arguments must be arrays.");const t=e.length<n.length?e.length:n.length;for(let r=0;r<t;r++)if(e[r]!==n[r])return e[r]<n[r]?-1:1;return e.length-n.length}export{Pe as c,S as n,ve as p,o as s};
