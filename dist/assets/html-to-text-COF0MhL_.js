import{h as b}from"./@selderee-yEdlZzad.js";import{p as G}from"./htmlparser2-Ch2Z3JHo.js";import{D as y}from"./selderee-BOLtqnD5.js";import{m as $}from"./deepmerge-B3UAOwEe.js";import{r as O}from"./dom-serializer-DSYhzfyK.js";function S(n,e,t=()=>{}){if(n===void 0){const s=function(...i){return e(s,...i)};return s}return n>=0?function(...s){return e(S(n-1,e,t),...s)}:t}function H(n,e){let t=0,s=n.length;for(;t<s&&n[t]===e;)++t;for(;s>t&&n[s-1]===e;)--s;return t>0||s<n.length?n.substring(t,s):n}function Q(n,e){let t=n.length;for(;t>0&&n[t-1]===e;)--t;return t<n.length?n.substring(0,t):n}function Y(n){return n.replace(/[\s\S]/g,e=>"\\u"+e.charCodeAt().toString(16).padStart(4,"0"))}function j(n,e){const t=new Map;for(let s=n.length;s-- >0;){const i=n[s],a=e(i);t.set(a,t.has(a)?$(i,t.get(a),{arrayMerge:Z}):i)}return[...t.values()].reverse()}const Z=(n,e,t)=>[...e];function B(n,e){for(const t of e){if(!n)return;n=n[t]}return n}function E(n,e="a",t=26){const s=[];do n-=1,s.push(n%t),n=n/t>>0;while(n>0);const i=e.charCodeAt(0);return s.reverse().map(a=>String.fromCharCode(i+a)).join("")}const _=["I","X","C","M"],R=["V","L","D"];function P(n){return[...n+""].map(e=>+e).reverse().map((e,t)=>e%5<4?(e<5?"":R[t])+_[t].repeat(e%5):_[t]+(e<5?R[t]:_[t+1])).reverse().join("")}class U{constructor(e,t=void 0){this.lines=[],this.nextLineWords=[],this.maxLineLength=t||e.wordwrap||Number.MAX_VALUE,this.nextLineAvailableChars=this.maxLineLength,this.wrapCharacters=B(e,["longWordSplit","wrapCharacters"])||[],this.forceWrapOnLimit=B(e,["longWordSplit","forceWrapOnLimit"])||!1,this.stashedSpace=!1,this.wordBreakOpportunity=!1}pushWord(e,t=!1){this.nextLineAvailableChars<=0&&!t&&this.startNewLine();const s=this.nextLineWords.length===0,i=e.length+(s?0:1);if(i<=this.nextLineAvailableChars||t)this.nextLineWords.push(e),this.nextLineAvailableChars-=i;else{const[a,...r]=this.splitLongWord(e);s||this.startNewLine(),this.nextLineWords.push(a),this.nextLineAvailableChars-=a.length;for(const o of r)this.startNewLine(),this.nextLineWords.push(o),this.nextLineAvailableChars-=o.length}}popWord(){const e=this.nextLineWords.pop();if(e!==void 0){const t=this.nextLineWords.length===0,s=e.length+(t?0:1);this.nextLineAvailableChars+=s}return e}concatWord(e,t=!1){if(this.wordBreakOpportunity&&e.length>this.nextLineAvailableChars)this.pushWord(e,t),this.wordBreakOpportunity=!1;else{const s=this.popWord();this.pushWord(s?s.concat(e):e,t)}}startNewLine(e=1){this.lines.push(this.nextLineWords),e>1&&this.lines.push(...Array.from({length:e-1},()=>[])),this.nextLineWords=[],this.nextLineAvailableChars=this.maxLineLength}isEmpty(){return this.lines.length===0&&this.nextLineWords.length===0}clear(){this.lines.length=0,this.nextLineWords.length=0,this.nextLineAvailableChars=this.maxLineLength}toString(){return[...this.lines,this.nextLineWords].map(e=>e.join(" ")).join(`
`)}splitLongWord(e){const t=[];let s=0;for(;e.length>this.maxLineLength;){const i=e.substring(0,this.maxLineLength),a=e.substring(this.maxLineLength),r=i.lastIndexOf(this.wrapCharacters[s]);if(r>-1)e=i.substring(r+1)+a,t.push(i.substring(0,r+1));else if(s++,s<this.wrapCharacters.length)e=i+a;else{if(this.forceWrapOnLimit){if(t.push(i),e=a,e.length>this.maxLineLength)continue}else e=i+a;break}}return t.push(e),t}}class x{constructor(e=null){this.next=e}getRoot(){return this.next?this.next:this}}class u extends x{constructor(e,t=null,s=1,i=void 0){super(t),this.leadingLineBreaks=s,this.inlineTextBuilder=new U(e,i),this.rawText="",this.stashedLineBreaks=0,this.isPre=t&&t.isPre,this.isNoWrap=t&&t.isNoWrap}}class A extends u{constructor(e,t=null,{interRowLineBreaks:s=1,leadingLineBreaks:i=2,maxLineLength:a=void 0,maxPrefixLength:r=0,prefixAlign:o="left"}={}){super(e,t,i,a),this.maxPrefixLength=r,this.prefixAlign=o,this.interRowLineBreaks=s}}class k extends u{constructor(e,t=null,{leadingLineBreaks:s=1,maxLineLength:i=void 0,prefix:a=""}={}){super(e,t,s,i),this.prefix=a}}class v extends x{constructor(e=null){super(e),this.rows=[],this.isPre=e&&e.isPre,this.isNoWrap=e&&e.isNoWrap}}class D extends x{constructor(e=null){super(e),this.cells=[],this.isPre=e&&e.isPre,this.isNoWrap=e&&e.isNoWrap}}class m extends x{constructor(e,t=null,s=void 0){super(t),this.inlineTextBuilder=new U(e,s),this.rawText="",this.stashedLineBreaks=0,this.isPre=t&&t.isPre,this.isNoWrap=t&&t.isNoWrap}}class ee extends x{constructor(e=null,t){super(e),this.transform=t}}function te(n){return[...n].map(e=>"\\u"+e.charCodeAt(0).toString(16).padStart(4,"0")).join("")}class ne{constructor(e){this.whitespaceChars=e.preserveNewlines?e.whitespaceCharacters.replace(/\n/g,""):e.whitespaceCharacters;const t=te(this.whitespaceChars);if(this.leadingWhitespaceRe=new RegExp(`^[${t}]`),this.trailingWhitespaceRe=new RegExp(`[${t}]$`),this.allWhitespaceOrEmptyRe=new RegExp(`^[${t}]*$`),this.newlineOrNonWhitespaceRe=new RegExp(`(\\n|[^\\n${t}])`,"g"),this.newlineOrNonNewlineStringRe=new RegExp("(\\n|[^\\n]+)","g"),e.preserveNewlines){const s=new RegExp(`\\n|[^\\n${t}]+`,"gm");this.shrinkWrapAdd=function(i,a,r=c=>c,o=!1){if(!i)return;const c=a.stashedSpace;let l=!1,h=s.exec(i);if(h)for(l=!0,h[0]===`
`?a.startNewLine():c||this.testLeadingWhitespace(i)?a.pushWord(r(h[0]),o):a.concatWord(r(h[0]),o);(h=s.exec(i))!==null;)h[0]===`
`?a.startNewLine():a.pushWord(r(h[0]),o);a.stashedSpace=c&&!l||this.testTrailingWhitespace(i)}}else{const s=new RegExp(`[^${t}]+`,"g");this.shrinkWrapAdd=function(i,a,r=c=>c,o=!1){if(!i)return;const c=a.stashedSpace;let l=!1,h=s.exec(i);if(h)for(l=!0,c||this.testLeadingWhitespace(i)?a.pushWord(r(h[0]),o):a.concatWord(r(h[0]),o);(h=s.exec(i))!==null;)a.pushWord(r(h[0]),o);a.stashedSpace=c&&!l||this.testTrailingWhitespace(i)}}}addLiteral(e,t,s=!0){if(!e)return;const i=t.stashedSpace;let a=!1,r=this.newlineOrNonNewlineStringRe.exec(e);if(r)for(a=!0,r[0]===`
`?t.startNewLine():i?t.pushWord(r[0],s):t.concatWord(r[0],s);(r=this.newlineOrNonNewlineStringRe.exec(e))!==null;)r[0]===`
`?t.startNewLine():t.pushWord(r[0],s);t.stashedSpace=i&&!a}testLeadingWhitespace(e){return this.leadingWhitespaceRe.test(e)}testTrailingWhitespace(e){return this.trailingWhitespaceRe.test(e)}testContainsWords(e){return!this.allWhitespaceOrEmptyRe.test(e)}countNewlinesNoWords(e){this.newlineOrNonWhitespaceRe.lastIndex=0;let t=0,s;for(;(s=this.newlineOrNonWhitespaceRe.exec(e))!==null;)if(s[0]===`
`)t++;else return 0;return t}}class se{constructor(e,t,s=void 0){this.options=e,this.picker=t,this.metadata=s,this.whitespaceProcessor=new ne(e),this._stackItem=new u(e),this._wordTransformer=void 0}pushWordTransform(e){this._wordTransformer=new ee(this._wordTransformer,e)}popWordTransform(){if(!this._wordTransformer)return;const e=this._wordTransformer.transform;return this._wordTransformer=this._wordTransformer.next,e}startNoWrap(){this._stackItem.isNoWrap=!0}stopNoWrap(){this._stackItem.isNoWrap=!1}_getCombinedWordTransformer(){const e=this._wordTransformer?s=>F(s,this._wordTransformer):void 0,t=this.options.encodeCharacters;return e?t?s=>t(e(s)):e:t}_popStackItem(){const e=this._stackItem;return this._stackItem=e.next,e}addLineBreak(){(this._stackItem instanceof u||this._stackItem instanceof k||this._stackItem instanceof m)&&(this._stackItem.isPre?this._stackItem.rawText+=`
`:this._stackItem.inlineTextBuilder.startNewLine())}addWordBreakOpportunity(){(this._stackItem instanceof u||this._stackItem instanceof k||this._stackItem instanceof m)&&(this._stackItem.inlineTextBuilder.wordBreakOpportunity=!0)}addInline(e,{noWordTransform:t=!1}={}){if(this._stackItem instanceof u||this._stackItem instanceof k||this._stackItem instanceof m){if(this._stackItem.isPre){this._stackItem.rawText+=e;return}if(!(e.length===0||this._stackItem.stashedLineBreaks&&!this.whitespaceProcessor.testContainsWords(e))){if(this.options.preserveNewlines){const s=this.whitespaceProcessor.countNewlinesNoWords(e);if(s>0){this._stackItem.inlineTextBuilder.startNewLine(s);return}}this._stackItem.stashedLineBreaks&&this._stackItem.inlineTextBuilder.startNewLine(this._stackItem.stashedLineBreaks),this.whitespaceProcessor.shrinkWrapAdd(e,this._stackItem.inlineTextBuilder,t?void 0:this._getCombinedWordTransformer(),this._stackItem.isNoWrap),this._stackItem.stashedLineBreaks=0}}}addLiteral(e){if((this._stackItem instanceof u||this._stackItem instanceof k||this._stackItem instanceof m)&&e.length!==0){if(this._stackItem.isPre){this._stackItem.rawText+=e;return}this._stackItem.stashedLineBreaks&&this._stackItem.inlineTextBuilder.startNewLine(this._stackItem.stashedLineBreaks),this.whitespaceProcessor.addLiteral(e,this._stackItem.inlineTextBuilder,this._stackItem.isNoWrap),this._stackItem.stashedLineBreaks=0}}openBlock({leadingLineBreaks:e=1,reservedLineLength:t=0,isPre:s=!1}={}){const i=Math.max(20,this._stackItem.inlineTextBuilder.maxLineLength-t);this._stackItem=new u(this.options,this._stackItem,e,i),s&&(this._stackItem.isPre=!0)}closeBlock({trailingLineBreaks:e=1,blockTransform:t=void 0}={}){const s=this._popStackItem(),i=t?t(g(s)):g(s);I(this._stackItem,i,s.leadingLineBreaks,Math.max(s.stashedLineBreaks,e))}openList({maxPrefixLength:e=0,prefixAlign:t="left",interRowLineBreaks:s=1,leadingLineBreaks:i=2}={}){this._stackItem=new A(this.options,this._stackItem,{interRowLineBreaks:s,leadingLineBreaks:i,maxLineLength:this._stackItem.inlineTextBuilder.maxLineLength,maxPrefixLength:e,prefixAlign:t})}openListItem({prefix:e=""}={}){if(!(this._stackItem instanceof A))throw new Error("Can't add a list item to something that is not a list! Check the formatter.");const t=this._stackItem,s=Math.max(e.length,t.maxPrefixLength),i=Math.max(20,t.inlineTextBuilder.maxLineLength-s);this._stackItem=new k(this.options,t,{prefix:e,maxLineLength:i,leadingLineBreaks:t.interRowLineBreaks})}closeListItem(){const e=this._popStackItem(),t=e.next,s=Math.max(e.prefix.length,t.maxPrefixLength),i=`
`+" ".repeat(s),r=(t.prefixAlign==="right"?e.prefix.padStart(s):e.prefix.padEnd(s))+g(e).replace(/\n/g,i);I(t,r,e.leadingLineBreaks,Math.max(e.stashedLineBreaks,t.interRowLineBreaks))}closeList({trailingLineBreaks:e=2}={}){const t=this._popStackItem(),s=g(t);s&&I(this._stackItem,s,t.leadingLineBreaks,e)}openTable(){this._stackItem=new v(this._stackItem)}openTableRow(){if(!(this._stackItem instanceof v))throw new Error("Can't add a table row to something that is not a table! Check the formatter.");this._stackItem=new D(this._stackItem)}openTableCell({maxColumnWidth:e=void 0}={}){if(!(this._stackItem instanceof D))throw new Error("Can't add a table cell to something that is not a table row! Check the formatter.");this._stackItem=new m(this.options,this._stackItem,e)}closeTableCell({colspan:e=1,rowspan:t=1}={}){const s=this._popStackItem(),i=H(g(s),`
`);s.next.cells.push({colspan:e,rowspan:t,text:i})}closeTableRow(){const e=this._popStackItem();e.next.rows.push(e.cells)}closeTable({tableToString:e,leadingLineBreaks:t=2,trailingLineBreaks:s=2}){const i=this._popStackItem(),a=e(i.rows);a&&I(this._stackItem,a,t,s)}toString(){return g(this._stackItem.getRoot())}}function g(n){if(!(n instanceof u||n instanceof k||n instanceof m))throw new Error("Only blocks, list items and table cells can be requested for text contents.");return n.inlineTextBuilder.isEmpty()?n.rawText:n.rawText+n.inlineTextBuilder.toString()}function I(n,e,t,s){if(!(n instanceof u||n instanceof k||n instanceof m))throw new Error("Only blocks, list items and table cells can contain text.");const i=g(n),a=Math.max(n.stashedLineBreaks,t);n.inlineTextBuilder.clear(),i?n.rawText=i+`
`.repeat(a)+e:(n.rawText=e,n.leadingLineBreaks=a),n.stashedLineBreaks=s}function F(n,e){return e?F(e.transform(n),e.next):n}function ie(n={}){const e=n.selectors.filter(r=>!r.format);if(e.length)throw new Error("Following selectors have no specified format: "+e.map(r=>`\`${r.selector}\``).join(", "));const t=new y(n.selectors.map(r=>[r.selector,r])).build(b);typeof n.encodeCharacters!="function"&&(n.encodeCharacters=ce(n.encodeCharacters));const s=new y(n.baseElements.selectors.map((r,o)=>[r,o+1])).build(b);function i(r){return ae(r,n,s)}const a=S(n.limits.maxDepth,oe,function(r,o){o.addInline(n.limits.ellipsis||"")});return function(r,o=void 0){return re(r,o,n,t,i,a)}}function re(n,e,t,s,i,a){const r=t.limits.maxInputLength;r&&n&&n.length>r&&(console.warn(`Input length ${n.length} is above allowed limit of ${r}. Truncating without ellipsis.`),n=n.substring(0,r));const o=G(n,{decodeEntities:t.decodeEntities}),c=i(o.children),l=new se(t,s,e);return a(c,l),l.toString()}function ae(n,e,t){const s=[];function i(r,o){o=o.slice(0,e.limits.maxChildNodes);for(const c of o){if(c.type!=="tag")continue;const l=t.pick1(c);if(l>0?s.push({selectorIndex:l,element:c}):c.children&&r(c.children),s.length>=e.limits.maxBaseElements)return}}return S(e.limits.maxDepth,i)(n),e.baseElements.orderBy!=="occurrence"&&s.sort((r,o)=>r.selectorIndex-o.selectorIndex),e.baseElements.returnDomByDefault&&s.length===0?n:s.map(r=>r.element)}function oe(n,e,t){if(!e)return;const s=t.options;e.length>s.limits.maxChildNodes&&(e=e.slice(0,s.limits.maxChildNodes),e.push({data:s.limits.ellipsis,type:"text"}));for(const a of e)switch(a.type){case"text":{t.addInline(a.data);break}case"tag":{const r=t.picker.pick1(a),o=s.formatters[r.format];o(a,n,t,r.options||{});break}}}function ce(n){if(!n||Object.keys(n).length===0)return;const e=Object.entries(n).filter(([,a])=>a!==!1),t=new RegExp(e.map(([a])=>`(${Y([...a][0])})`).join("|"),"g"),s=e.map(([,a])=>a),i=(a,...r)=>s[r.findIndex(o=>o)];return a=>a.replace(t,i)}function le(n,e,t,s){}function he(n,e,t,s){t.addLiteral(s.string||"")}function fe(n,e,t,s){t.openBlock({leadingLineBreaks:s.leadingLineBreaks||2}),t.addLiteral(s.string||""),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks||2})}function de(n,e,t,s){e(n.children,t)}function pe(n,e,t,s){t.openBlock({leadingLineBreaks:s.leadingLineBreaks||2}),e(n.children,t),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks||2})}function q(n){const e=n.attribs&&n.attribs.length?" "+Object.entries(n.attribs).map(([t,s])=>s===""?t:`${t}=${s.replace(/"/g,"&quot;")}`).join(" "):"";return`<${n.name}${e}>`}function z(n){return`</${n.name}>`}function ue(n,e,t,s){t.startNoWrap(),t.addLiteral(q(n)),t.stopNoWrap(),e(n.children,t),t.startNoWrap(),t.addLiteral(z(n)),t.stopNoWrap()}function ge(n,e,t,s){t.openBlock({leadingLineBreaks:s.leadingLineBreaks||2}),t.startNoWrap(),t.addLiteral(q(n)),t.stopNoWrap(),e(n.children,t),t.startNoWrap(),t.addLiteral(z(n)),t.stopNoWrap(),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks||2})}function ke(n,e,t,s){t.startNoWrap(),t.addLiteral(O(n,{decodeEntities:t.options.decodeEntities})),t.stopNoWrap()}function me(n,e,t,s){t.openBlock({leadingLineBreaks:s.leadingLineBreaks||2}),t.startNoWrap(),t.addLiteral(O(n,{decodeEntities:t.options.decodeEntities})),t.stopNoWrap(),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks||2})}function Le(n,e,t,s){t.addLiteral(s.prefix||""),e(n.children,t),t.addLiteral(s.suffix||"")}var Be=Object.freeze({__proto__:null,block:pe,blockHtml:me,blockString:fe,blockTag:ge,inline:de,inlineHtml:ke,inlineString:he,inlineSurround:Le,inlineTag:ue,skip:le});function W(n,e){return n[e]||(n[e]=[]),n[e]}function we(n,e=0){for(;n[e];)e++;return e}function xe(n,e){for(let t=0;t<e;t++){const s=W(n,t);for(let i=0;i<t;i++){const a=W(n,i);if(s[i]||a[t]){const r=s[i];s[i]=a[t],a[t]=r}}}}function Ie(n,e,t,s){for(let i=0;i<n.rowspan;i++){const a=W(e,t+i);for(let r=0;r<n.colspan;r++)a[s+r]=n}}function T(n,e){return n[e]===void 0&&(n[e]=e===0?0:1+T(n,e-1)),n[e]}function M(n,e,t,s){n[e+t]=Math.max(T(n,e+t),T(n,e)+s)}function We(n,e,t){const s=[];let i=0;const a=n.length,r=[0];for(let l=0;l<a;l++){const h=W(s,l),f=n[l];let L=0;for(let d=0;d<f.length;d++){const p=f[d];L=we(h,L),Ie(p,s,l,L),L+=p.colspan,p.lines=p.text.split(`
`);const w=p.lines.length;M(r,l,p.rowspan,w+e)}i=h.length>i?h.length:i}xe(s,a>i?a:i);const o=[],c=[0];for(let l=0;l<i;l++){let h=0,f;const L=Math.min(a,s[l].length);for(;h<L;)if(f=s[l][h],f){if(!f.rendered){let d=0;for(let p=0;p<f.lines.length;p++){const w=f.lines[p],N=r[h]+p;o[N]=(o[N]||"").padEnd(c[l])+w,d=w.length>d?w.length:d}M(c,l,f.colspan,d+t),f.rendered=!0}h+=f.rowspan}else{const d=r[h];o[d]=o[d]||"",h++}}return o.join(`
`)}function _e(n,e,t,s){t.addLineBreak()}function Te(n,e,t,s){t.addWordBreakOpportunity()}function Ce(n,e,t,s){t.openBlock({leadingLineBreaks:s.leadingLineBreaks||2}),t.addInline("-".repeat(s.length||t.options.wordwrap||40)),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks||2})}function Se(n,e,t,s){t.openBlock({leadingLineBreaks:s.leadingLineBreaks||2}),e(n.children,t),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks||2})}function Ne(n,e,t,s){t.openBlock({isPre:!0,leadingLineBreaks:s.leadingLineBreaks||2}),e(n.children,t),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks||2})}function be(n,e,t,s){t.openBlock({leadingLineBreaks:s.leadingLineBreaks||2}),s.uppercase!==!1?(t.pushWordTransform(i=>i.toUpperCase()),e(n.children,t),t.popWordTransform()):e(n.children,t),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks||2})}function ye(n,e,t,s){t.openBlock({leadingLineBreaks:s.leadingLineBreaks||2,reservedLineLength:2}),e(n.children,t),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks||2,blockTransform:i=>(s.trimEmptyLines!==!1?H(i,`
`):i).split(`
`).map(a=>"> "+a).join(`
`)})}function C(n,e){if(!e)return n;const t=typeof e[0]=="string"?e[0]:"[",s=typeof e[1]=="string"?e[1]:"]";return t+n+s}function V(n,e,t,s,i){const a=typeof e=="function"?e(n,s,i):n;return a[0]==="/"&&t?Q(t,"/")+a:a}function Ee(n,e,t,s){const i=n.attribs||{},a=i.alt?i.alt:"",r=i.src?V(i.src,s.pathRewrite,s.baseUrl,t.metadata,n):"",o=r?a?a+" "+C(r,s.linkBrackets):C(r,s.linkBrackets):a;t.addInline(o,{noWordTransform:!0})}function Re(n,e,t,s){function i(){if(s.ignoreHref||!n.attribs||!n.attribs.href)return"";let r=n.attribs.href.replace(/^mailto:/,"");return s.noAnchorUrl&&r[0]==="#"?"":(r=V(r,s.pathRewrite,s.baseUrl,t.metadata,n),r)}const a=i();if(!a)e(n.children,t);else{let r="";t.pushWordTransform(c=>(c&&(r+=c),c)),e(n.children,t),t.popWordTransform(),s.hideLinkHrefIfSameAsText&&a===r||t.addInline(r?" "+C(a,s.linkBrackets):a,{noWordTransform:!0})}}function X(n,e,t,s,i){const a=B(n,["parent","name"])==="li";let r=0;const o=(n.children||[]).filter(c=>c.type!=="text"||!/^\s*$/.test(c.data)).map(function(c){if(c.name!=="li")return{node:c,prefix:""};const l=a?i().trimStart():i();return l.length>r&&(r=l.length),{node:c,prefix:l}});if(o.length){t.openList({interRowLineBreaks:1,leadingLineBreaks:a?1:s.leadingLineBreaks||2,maxPrefixLength:r,prefixAlign:"left"});for(const{node:c,prefix:l}of o)t.openListItem({prefix:l}),e([c],t),t.closeListItem();t.closeList({trailingLineBreaks:a?1:s.trailingLineBreaks||2})}}function Pe(n,e,t,s){const i=s.itemPrefix||" * ";return X(n,e,t,s,()=>i)}function Ae(n,e,t,s){let i=Number(n.attribs.start||"1");const a=ve(n.attribs.type);return X(n,e,t,s,()=>" "+a(i++)+". ")}function ve(n="1"){switch(n){case"a":return e=>E(e,"a");case"A":return e=>E(e,"A");case"i":return e=>P(e).toLowerCase();case"I":return e=>P(e);case"1":default:return e=>e.toString()}}function De(n){const e=[],t=[];for(const s of n)s.startsWith(".")?e.push(s.substring(1)):s.startsWith("#")&&t.push(s.substring(1));return{classes:e,ids:t}}function Me(n,e){if(e===!0)return!0;if(!n)return!1;const{classes:t,ids:s}=De(e),i=(n.class||"").split(" "),a=(n.id||"").split(" ");return i.some(r=>t.includes(r))||a.some(r=>s.includes(r))}function $e(n,e,t,s){return Me(n.attribs,t.options.tables)?J(n,e,t,s):Oe(n,e,t,s)}function Oe(n,e,t,s){t.openBlock({leadingLineBreaks:s.leadingLineBreaks}),e(n.children,t),t.closeBlock({trailingLineBreaks:s.trailingLineBreaks})}function J(n,e,t,s){t.openTable(),n.children.forEach(a),t.closeTable({tableToString:r=>We(r,s.rowSpacing??0,s.colSpacing??3),leadingLineBreaks:s.leadingLineBreaks,trailingLineBreaks:s.trailingLineBreaks});function i(r){const o=+B(r,["attribs","colspan"])||1,c=+B(r,["attribs","rowspan"])||1;t.openTableCell({maxColumnWidth:s.maxColumnWidth}),e(r.children,t),t.closeTableCell({colspan:o,rowspan:c})}function a(r){if(r.type!=="tag")return;const o=s.uppercaseHeaderCells!==!1?c=>{t.pushWordTransform(l=>l.toUpperCase()),i(c),t.popWordTransform()}:i;switch(r.name){case"thead":case"tbody":case"tfoot":case"center":r.children.forEach(a);return;case"tr":{t.openTableRow();for(const c of r.children)if(c.type==="tag")switch(c.name){case"th":{o(c);break}case"td":{i(c);break}}t.closeTableRow();break}}}}var He=Object.freeze({__proto__:null,anchor:Re,blockquote:ye,dataTable:J,heading:be,horizontalLine:Ce,image:Ee,lineBreak:_e,orderedList:Ae,paragraph:Se,pre:Ne,table:$e,unorderedList:Pe,wbr:Te});const je={baseElements:{selectors:["body"],orderBy:"selectors",returnDomByDefault:!0},decodeEntities:!0,encodeCharacters:{},formatters:{},limits:{ellipsis:"...",maxBaseElements:void 0,maxChildNodes:void 0,maxDepth:void 0,maxInputLength:1<<24},longWordSplit:{forceWrapOnLimit:!1,wrapCharacters:[]},preserveNewlines:!1,selectors:[{selector:"*",format:"inline"},{selector:"a",format:"anchor",options:{baseUrl:null,hideLinkHrefIfSameAsText:!1,ignoreHref:!1,linkBrackets:["[","]"],noAnchorUrl:!0}},{selector:"article",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"aside",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"blockquote",format:"blockquote",options:{leadingLineBreaks:2,trailingLineBreaks:2,trimEmptyLines:!0}},{selector:"br",format:"lineBreak"},{selector:"div",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"footer",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"form",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"h1",format:"heading",options:{leadingLineBreaks:3,trailingLineBreaks:2,uppercase:!0}},{selector:"h2",format:"heading",options:{leadingLineBreaks:3,trailingLineBreaks:2,uppercase:!0}},{selector:"h3",format:"heading",options:{leadingLineBreaks:3,trailingLineBreaks:2,uppercase:!0}},{selector:"h4",format:"heading",options:{leadingLineBreaks:2,trailingLineBreaks:2,uppercase:!0}},{selector:"h5",format:"heading",options:{leadingLineBreaks:2,trailingLineBreaks:2,uppercase:!0}},{selector:"h6",format:"heading",options:{leadingLineBreaks:2,trailingLineBreaks:2,uppercase:!0}},{selector:"header",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"hr",format:"horizontalLine",options:{leadingLineBreaks:2,length:void 0,trailingLineBreaks:2}},{selector:"img",format:"image",options:{baseUrl:null,linkBrackets:["[","]"]}},{selector:"main",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"nav",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"ol",format:"orderedList",options:{leadingLineBreaks:2,trailingLineBreaks:2}},{selector:"p",format:"paragraph",options:{leadingLineBreaks:2,trailingLineBreaks:2}},{selector:"pre",format:"pre",options:{leadingLineBreaks:2,trailingLineBreaks:2}},{selector:"section",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"table",format:"table",options:{colSpacing:3,leadingLineBreaks:2,maxColumnWidth:60,rowSpacing:0,trailingLineBreaks:2,uppercaseHeaderCells:!0}},{selector:"ul",format:"unorderedList",options:{itemPrefix:" * ",leadingLineBreaks:2,trailingLineBreaks:2}},{selector:"wbr",format:"wbr"}],tables:[],whitespaceCharacters:` 	\r
\f​`,wordwrap:80},Ue=(n,e,t)=>[...n,...e],K=(n,e,t)=>[...e],Fe=(n,e,t)=>n.some(s=>typeof s=="object")?Ue(n,e):K(n,e);function qe(n={}){return n=$(je,n,{arrayMerge:K,customMerge:e=>e==="selectors"?Fe:void 0}),n.formatters=Object.assign({},Be,He,n.formatters),n.selectors=j(n.selectors,e=>e.selector),ze(n),ie(n)}function Qe(n,e={},t=void 0){return qe(e)(n,t)}function ze(n){if(n.tags){const t=Object.entries(n.tags).map(([s,i])=>({...i,selector:s||"*"}));n.selectors.push(...t),n.selectors=j(n.selectors,s=>s.selector)}function e(t,s,i){const a=s.pop();for(const r of s){let o=t[r];o||(o={},t[r]=o),t=o}t[a]=i}if(n.baseElement){const t=n.baseElement;e(n,["baseElements","selectors"],Array.isArray(t)?t:[t])}n.returnDomByDefault!==void 0&&e(n,["baseElements","returnDomByDefault"],n.returnDomByDefault);for(const t of n.selectors)t.format==="anchor"&&B(t,["options","noLinkBrackets"])&&e(t,["options","linkBrackets"],!1)}export{Qe as c};
